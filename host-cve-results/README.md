# Host Scanning Report #

In Sysdigs Legacy Engine there were no mechanisms to generate a report for a specific CVE that was detected on a host. This script will parse the API and perform one of two functions. It will either display a full inventory of results or an inventory of hosts with a specific CVE.

## Arguments ##

```sh
usage: host-scan-check-for-cve.py [-h] --sysdig_uri U --sysdig_token T [--vulnerability V]

Query sysdig hosts for a CVE

optional arguments:
  -h, --help         show this help message and exit
  --sysdig_uri U     Sysdig Secure URI
  --sysdig_token T   Sysdig Secure Token to authenticate against the URI
  --vulnerability V  Vulnerability ID as found in Sysdig Secure.
```

### Example Use ###

#### Parsing for a Specific Vulnerability ####
```sh
export SYSDIG_SECURE_URL=https://us2.app.sysdig.com
export TOKEN=<insert your Sysdig Secure token here>
python3 ./host-scan-check-for-cve.py --sysdig_uri $SYSDIG_SECURE_URL --sysdig_token $SYSDIG_SECURE_TOKEN --vulnerability VULNDB-304256
{
    "results": [
        {
            "hostname": "sysdig-agent-node-analyzer-v69f5",
            "lastScanDate": "2022-10-31T21:12:20.639028Z",
            "operatingSystem": "flatcar",
            "vulns": [
                {
                    "disclosure_date": 1666656000,
                    "feed": "vulndb",
                    "feed_group": "vulndb:vulnerabilities",
                    "fix": "None",
                    "package": "openssl-3.0.2",
                    "package_cpe": "cpe:/a:-:openssl:3.0.2:-:-",
                    "package_name": "openssl",
                    "package_path": "openssl",
                    "package_type": "binary",
                    "package_version": "3.0.2",
                    "severity": "Critical",
                    "url": "https://us2.app.sysdig.com/secure//#/scanning/vulnerabilities/VULNDB-304256",
                    "vendor_data": [
                        {
                            "cvss_v2": {
                                "base_score": 10,
                                "exploitability_score": 10,
                                "impact_score": 10
                            },
                            "cvss_v3": {
                                "base_score": 9.8,
                                "exploitability_score": 3.9,
                                "impact_score": 5.9
                            },
                            "id": "VULNDB-304256"
                        }
                    ],
                    "vuln": "VULNDB-304256",
                    "vulnexceptions": null
                }
            ]
        },
...
        {
            "hostname": "sysdig-agent-node-analyzer-fk9db",
            "lastScanDate": "2022-10-31T21:01:05.04272Z",
            "operatingSystem": "flatcar",
            "vulns": [
                {
                    "disclosure_date": 1666656000,
                    "feed": "vulndb",
                    "feed_group": "vulndb:vulnerabilities",
                    "fix": "None",
                    "package": "openssl-3.0.2",
                    "package_cpe": "cpe:/a:-:openssl:3.0.2:-:-",
                    "package_name": "openssl",
                    "package_path": "openssl",
                    "package_type": "binary",
                    "package_version": "3.0.2",
                    "severity": "Critical",
                    "url": "https://us2.app.sysdig.com/secure//#/scanning/vulnerabilities/VULNDB-304256",
                    "vendor_data": [
                        {
                            "cvss_v2": {
                                "base_score": 10,
                                "exploitability_score": 10,
                                "impact_score": 10
                            },
                            "cvss_v3": {
                                "base_score": 9.8,
                                "exploitability_score": 3.9,
                                "impact_score": 5.9
                            },
                            "id": "VULNDB-304256"
                        }
                    ],
                    "vuln": "VULNDB-304256",
                    "vulnexceptions": null
                }
            ]
        }
    ]
}
```

